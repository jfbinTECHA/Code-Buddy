{"version":3,"file":"http-adapter.factory.js","sourceRoot":"","sources":["../../../src/mcp/adapters/http-adapter.factory.ts"],"names":[],"mappings":";;;AACA,iEAA4D;AAC5D,iEAA4D;AAK5D,MAAa,kBAAkB;IAO7B,MAAM,CAAC,UAAU,CAAC,GAAQ,EAAE,GAAQ;QAElC,IAAI,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,IAAI,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,EAAE,CAAC;YAC9D,IAAI,CAAC,IAAI,CAAC,cAAc,EAAE,CAAC;gBACzB,IAAI,CAAC,cAAc,GAAG,IAAI,yCAAkB,EAAE,CAAC;YACjD,CAAC;YACD,OAAO,IAAI,CAAC,cAAc,CAAC;QAC7B,CAAC;QAGD,IAAI,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,IAAI,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,CAAC;YAC3D,IAAI,CAAC,IAAI,CAAC,cAAc,EAAE,CAAC;gBACzB,IAAI,CAAC,cAAc,GAAG,IAAI,yCAAkB,EAAE,CAAC;YACjD,CAAC;YACD,OAAO,IAAI,CAAC,cAAc,CAAC;QAC7B,CAAC;QAGD,IAAI,CAAC,IAAI,CAAC,cAAc,EAAE,CAAC;YACzB,IAAI,CAAC,cAAc,GAAG,IAAI,yCAAkB,EAAE,CAAC;QACjD,CAAC;QACD,OAAO,IAAI,CAAC,cAAc,CAAC;IAC7B,CAAC;IAKO,MAAM,CAAC,gBAAgB,CAAC,GAAQ;QACtC,OAAO,OAAO,CACZ,GAAG;YACD,OAAO,GAAG,KAAK,QAAQ;YACvB,OAAO,GAAG,CAAC,GAAG,KAAK,UAAU;YAC7B,GAAG,CAAC,MAAM,KAAK,SAAS;YACxB,GAAG,CAAC,GAAG,KAAK,SAAS;YACrB,CAAC,GAAG,CAAC,YAAY,CACpB,CAAC;IACJ,CAAC;IAKO,MAAM,CAAC,iBAAiB,CAAC,GAAQ;QACvC,OAAO,OAAO,CACZ,GAAG;YACD,OAAO,GAAG,KAAK,QAAQ;YACvB,OAAO,GAAG,CAAC,MAAM,KAAK,UAAU;YAChC,OAAO,GAAG,CAAC,IAAI,KAAK,UAAU;YAC9B,OAAO,GAAG,CAAC,IAAI,KAAK,UAAU;YAC9B,GAAG,CAAC,WAAW,KAAK,SAAS;YAC7B,CAAC,GAAG,CAAC,IAAI,CACZ,CAAC;IACJ,CAAC;IAKO,MAAM,CAAC,gBAAgB,CAAC,GAAQ;QACtC,OAAO,OAAO,CACZ,GAAG;YACD,OAAO,GAAG,KAAK,QAAQ;YACvB,GAAG,CAAC,YAAY,KAAK,SAAS;YAC9B,GAAG,CAAC,MAAM,KAAK,SAAS;YACxB,GAAG,CAAC,GAAG,KAAK,SAAS,CACxB,CAAC;IACJ,CAAC;IAKO,MAAM,CAAC,cAAc,CAAC,GAAQ;QACpC,OAAO,OAAO,CACZ,GAAG;YACD,OAAO,GAAG,KAAK,QAAQ;YACvB,OAAO,GAAG,CAAC,MAAM,KAAK,UAAU;YAChC,OAAO,GAAG,CAAC,IAAI,KAAK,UAAU;YAC9B,OAAO,GAAG,CAAC,MAAM,KAAK,UAAU;YAChC,GAAG,CAAC,IAAI,KAAK,SAAS,CACzB,CAAC;IACJ,CAAC;;AArFH,gDAsFC;AArFgB,iCAAc,GAA8B,IAAI,CAAC;AACjD,iCAAc,GAA8B,IAAI,CAAC","sourcesContent":["import { HttpAdapter } from '../interfaces/http-adapter.interface';\nimport { ExpressHttpAdapter } from './express-http.adapter';\nimport { FastifyHttpAdapter } from './fastify-http.adapter';\n\n/**\n * Factory for creating HTTP adapters based on the detected framework\n */\nexport class HttpAdapterFactory {\n  private static expressAdapter: ExpressHttpAdapter | null = null;\n  private static fastifyAdapter: FastifyHttpAdapter | null = null;\n\n  /**\n   * Get the appropriate HTTP adapter for the given request/response objects\n   */\n  static getAdapter(req: any, res: any): HttpAdapter {\n    // Check if it's Express by looking for Express-specific properties\n    if (this.isExpressRequest(req) && this.isExpressResponse(res)) {\n      if (!this.expressAdapter) {\n        this.expressAdapter = new ExpressHttpAdapter();\n      }\n      return this.expressAdapter;\n    }\n\n    // Check if it's Fastify by looking for Fastify-specific properties\n    if (this.isFastifyRequest(req) && this.isFastifyReply(res)) {\n      if (!this.fastifyAdapter) {\n        this.fastifyAdapter = new FastifyHttpAdapter();\n      }\n      return this.fastifyAdapter;\n    }\n\n    // Default to Express adapter for backward compatibility\n    if (!this.expressAdapter) {\n      this.expressAdapter = new ExpressHttpAdapter();\n    }\n    return this.expressAdapter;\n  }\n\n  /**\n   * Check if the request object is from Express\n   */\n  private static isExpressRequest(req: any): boolean {\n    return Boolean(\n      req &&\n        typeof req === 'object' &&\n        typeof req.get === 'function' &&\n        req.method !== undefined &&\n        req.url !== undefined &&\n        !req.routeOptions, // Fastify-specific property\n    );\n  }\n\n  /**\n   * Check if the response object is from Express\n   */\n  private static isExpressResponse(res: any): boolean {\n    return Boolean(\n      res &&\n        typeof res === 'object' &&\n        typeof res.status === 'function' &&\n        typeof res.json === 'function' &&\n        typeof res.send === 'function' &&\n        res.headersSent !== undefined &&\n        !res.sent, // Fastify-specific property\n    );\n  }\n\n  /**\n   * Check if the request object is from Fastify\n   */\n  private static isFastifyRequest(req: any): boolean {\n    return Boolean(\n      req &&\n        typeof req === 'object' &&\n        req.routeOptions !== undefined && // Fastify-specific property\n        req.method !== undefined &&\n        req.url !== undefined,\n    );\n  }\n\n  /**\n   * Check if the response object is from Fastify (FastifyReply)\n   */\n  private static isFastifyReply(res: any): boolean {\n    return Boolean(\n      res &&\n        typeof res === 'object' &&\n        typeof res.status === 'function' &&\n        typeof res.send === 'function' &&\n        typeof res.header === 'function' &&\n        res.sent !== undefined, // Fastify-specific property\n    );\n  }\n}\n"]}